import {HashHelper} from "../helper/hashHelper";
import bigInt from "big-integer";
import {BigNumberHelper} from "../helper/bigNumberHelper";

describe("HashHelper test", () => {
    it("should produce same hash as c#",
        () => {
            let result = HashHelper.getHash(bigInt(1024), [bigInt(3), bigInt(2), bigInt(10)]);

            expect(result.toString()).toStrictEqual(bigInt(724).toString());
        });

    it("should produce same short code as in c#", () => {
        let c1: string = "25d4d241a18fa26fddba11d3bef3b5ea54da2c0cf9c406e1a1398352b6c4ed9fdf674b15ca6d0acdff08468c073e5061e8314e7c0bc2a3c0216b134a75b466dda22416a7012ff14e68999af5283fa7a7d54533e97ae24c6337f5f3e6147779f65e878f2547b963a8a969b47a33456cb12b779d5e8df4840f89f6faffe5b3983b1c234f153b88337eff49ec0419555558bcb6dbaf2ca43f1533ef11a7a906ed9d03783c4e6091dae4efa70382eb29ac8b0d4577812fcf981585e374ce51716ad3086bdedf9fe3a1604a0384d4ac5b80cebc1d08b8c78032ccb5c557986cfaeaad675c513f0337978cb91d41d8f91b8a0585c29302b60864c20fb42a0f6307bbed";
        let d1: string = "b858b7bd4193168a8ae0bc963296e4e6773acdc88726de9dc802b7ebe8735460fd01a3dabfe7b6e586c579e5f32d07da8fac7711444498bee052f6b0803f091ddeb08a7f70da182c067e9f384f24ed4b951ade81a73688d186d354b23c8e87ae1a5fdb5ba9da726b00030952b62b4216784cea869438509b3a38b92233437d9a0c1023c7b83563da64adf12f83d0817f2f8404905168d987edb8628c85dbc7af0c236d20efe1de3fa526b8b6df980710f862382e02843d58ecaf41c5549d197e58362e6fe6c6a43b5c4b5b5b52db7e30a01c98bb176b437eeb912ce70e095cf200b136709e8b7dfa782ca953e2ac66cfa9e5ceaf4c4729fa03b04dc263c13ff4";

        let c2: string = "370bb6adf7d0d505cfbf4fd86f0676eb18134fe643b9e8a29913a9be0c2b692e268a94f13fe6461969313d7fda8fedecdc92c17243c70b2ba0337548e9d60d49c8e8459b6017b62d75df8d769dc0cd34e3513cf52739463509baf7a79aa1cf619b68b2e45fb5911d7976905d5299e7584bd65f0fd65ecacb59b92f2e90b56b9c87f7639972d57e9660fb49a8b023cd991faf04610364cb0adf33d3dff0aa437152119f5979d34e23b51390660dcfd76a2e04fb0310280032d06297c5aac6fbe632ff3af6be71bec5ceeb058e9babf3d792a19abc50c403cacfc7baf96992db78e964631aea25e7708c498fcf664fde470f88c7468565a569c403188cf65bc728";
        let d2: string = "77d7f87da77603e0261065634776968a9ddd54dd15b3cc7cfeaa03c76aa3f0b0ed27b7d40dc3c5032e63295d3a8b79fc6ade7e0cda389f385cfc75eebb5bd4836ca1afce26108584eb9be4d5a57d2af79becf9a1eb92aa9b93342a1057a52021158c620b33f944feb7cc6c96fcb972ffc6be6ad90b695a0fb3e16f7154950193864386f45c1e3f6ebd4063d576481ec87b72f2e6a2a5591576f801bca4d7e4c05e60c52379864617ba17f2cf332b3da89cdc71c866cff8c548dc85850775af9c3bf57e4b8af261d39b021e88d0275659bbfebb66f7d603f82fbb3cc0aee08b434a09993d92d6411dfcc1c1d5bd646eb3d987882c7a9ca6e213bca2312ba608a6";

        let c3: string = "873c423396941beccd457a8c2a4e477e0021ebda2b13dc7ed1cfbd455612f3b5c35e0bd521fd3cf6552e89773186954f9c8899ff18c5800dcff8568785b0a104bcdc440b540447e0cae352f2f066a4a6a4b7c886d7faf42b011aa673a9b07ec83af60bdddc8e483d1c37ed49af5231af5916c94bbb8cea5e697acc71bb14354dac941049c2dbdd4b70c02bdbee2fd37a3863c7d6e9d47c890139c760b1bd01bb48bbc656b66e28e6846b23305ee9739ee36bfa29f9e3c6fb532b85b4e62a2f48384855a8a919a26ae825db44aaa3f88cc85e69e5c4e7f9b8076cbbabc59f5bc380a8724a2aecafe6d1f14da962c2a49cf952cc957998067361f83f0bf8b2192a";
        let d3: string = "639cf409e87400c869dd7ac68e779c9e2ed360904b7a001b96a05ade9fb5157d3b4125a9716ec35ba06200d7aa2b5941969dec6bdd19dc4c846f238cb6b2d1ed3c5b4c0613fc558d198a9755494f7ba0bc589d7368b43222c0b851b42ec0d442109d13528a89c396cba5801c24c0bc4c7f5f4cb51c0efb5b19079602ffd3bc1e4c210d0776ef873c2b4e616c13e01c59883996f1864634911eda4155df3cecc1d17e546002ec5f68680f4c422e53eb8e7d0af066b3da226ae99ef57d56c35cbf11032c7ac19fbb502f83fc5225b8925fcd5ea60de25d599b5650149e2159668c72f5e72effb207e1314e69790efc9db1bad42b5f6afd8136952afe5121bd05e9";

        let c4: string = "13dc2268d8a73300a414e02e195e00e09c72b32bbfcd3692a4e5a568d476b159b6174da1434a9df916b063532553d013ec328587415587a79b928a6f7cddec255ce5c9fc2897a912ccfe4b1a4e1f86f5b99e07d993d989c13e261da42edec8c6f3b537c80fa65fefb2856367ef10faa68318fc06ce4b46aba5f7b9a4da9ef8b6c523cbac874cf8f388a945c1004c1662f1777c1eec146d6fcc1fd754342f9185ef44712b954c4abc1b73d7138d6df71045e7ed7ffff796fe01a7727a00cac7ebfa4efce9cce9d42af7045b53fa97fb618684b60a347a089363aa9462e758d3bc7ab6473cebaf86cdf832f0525e8c8144257cf525356b450e9dffcf0846ad2fae";
        let d4: string = "2db1ca196564f3294e270e1a3b76557178c46953ec4824bc8032cb37eb0b1c75b8faf96840ed58e29c808cc5f616a297c2e14790839502bab007da201f061ed13ef380420df93553151be74753d6f52c4480e0354e4b57a4df9d723922f8318429032e8a1e593e98d018d99206b9a9439765ea00c649eddd60b5e7ecf8adc2ddc35c87291dd4613870fd8c5b2dd61346a0064e9d471fdcb125f00afda86b8c3a705b8529f336690143d39e582e325a6e65ee1af690978f7dffc5d430754c25a65f558b49a58b4165b54fb2eb536cac8cce565ea2c1b56df8027e6482fecc322bb503a77c7fc8c8ed3e3d98ea7440dc6e49b3faf77d92e8a78752046933d53fd5";

        let c5: string = "d7a685e4a19f54d5ffe33743e303876ab4756eddf181a8a1326ee9e745bdaf5dc12577ac9cdb68ba434bcbfcaa4edb23a3ab7f2b0c02cd65cf16646cedba5e9ffcf83053fcedeb0e71fe51dcad6b55fbd20c48e7d5d32208b044314e1cd7d5ae396d00bf39fbaf5cde7422809ce0d6198a37a375a58f3f07e18f335c02132304972b28433f5ac3ef571376a9998f71af996af9cd391487594268aa4761506fb82abb3721c0d8bffda7d54576e0d57dca79dd548c0dd5174892f6b2ca443859e0f57f4aec490c6b3a8db0c909a9c1e59ab8536c761cfb00816b9e1ddaf5a894a90753d2c9672ce7fb67d2c21ed0633301f11ac1cdada7e63669b64689a5c23b95";
        let d5: string = "88c56079cde76dc40bcd313ce99b2577f45370a7cf9b7c4e17ac81dd5e2f4c2d452ed0308d21e0bb26eeab003af6cadcdf558bb43964ad4d33e506dbd5956ba988d78f8a9e3d80bd9ef60c763604d5525714dc5d6e103d987d7cdf3a827bdaf540b69a6098886ca401e0426b9fdfaeec4987293117474d5398bf6353e3029f32a6f0be1eaf375b44e6a446e75e1afc9218b5ce0fffa04717f84fe2a711cb0a0eb4330b23036b5d2729d41d438ee9181ab86fc57721a7bbc927dd0e230c40a24cf8ec497db6a01a7ad3f85a2ea076d7600ccf927e4de7744ff4f687ef4e36538536d611ac11a08c75e7fca921620e091fe0a9928fa3de262af9d28497650b9ebe";

        let result: string = HashHelper.getCipherHash([{
            c: BigNumberHelper.fromHexString(c1),
            d: BigNumberHelper.fromHexString(d1)
        }, {
            c: BigNumberHelper.fromHexString(c2),
            d: BigNumberHelper.fromHexString(d2)
        }, {
            c: BigNumberHelper.fromHexString(c3),
            d: BigNumberHelper.fromHexString(d3)
        }, {
            c: BigNumberHelper.fromHexString(c4),
            d: BigNumberHelper.fromHexString(d4)
        }, {
            c: BigNumberHelper.fromHexString(c5),
            d: BigNumberHelper.fromHexString(d5)
        }]);

        console.log(result);
        expect(result.substring(0,2)).toStrictEqual("5d");

    });
});