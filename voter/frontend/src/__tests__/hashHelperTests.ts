import {HashHelper} from "../helper/hashHelper";
import bigInt from "big-integer";
import {BigNumberHelper} from "../helper/bigNumberHelper";

describe("HashHelper test", () => {
    it("should produce same hash as c#",
        () => {
            let result = HashHelper.getHash(bigInt(1024), [bigInt(3), bigInt(2), bigInt(10)]);

            expect(result.toString()).toStrictEqual(bigInt(724).toString());
        });

    it("should produce same short code as in c#", () => {
        let c1: string = "367611ab94a08fa336d6f5b91dc8c9f3e7e5b82d3305999c1bd059054094d921117592dc0c2314ec417ced04afa82ed0e17f59ea483155afc8a3f26f769acdd1a65933ea9efb1b6f0a1172df53ed55af7902a1640f8ad38c43a90f5c55ba72532fda8f1c9defc5cca1a6d04327b3a3cd694a705633eaa6a04f2853b5e86cae732eb921b9fd3faf6be681ba50bfb1ac574431971648667b9a2eed0f3d4a53d9b47923165d9dd5afa936269e6e216c66a6bcb1a1ed1ae7259901004f9617540c4247b440e916deb17a8d925588bef4c1325cb49d7d36ea8a21d6966453a904ced7fed279117dc9d9b564e87170e793d2ae3a698108692ee7cf6e0b033c65ab528b";
        let d1: string = "5a76c6097554fc61390c5a0dc1fc3fecb7e03039ad0590090b8ab6484ebe9ad05b9f176996bbe7adca1f14b072cc255642958b2c5bac68028f2a273b86029e1e8b9bd3d420b331f93897a57f89f77676afc4d49c532f37b4e8a850ae1f00f0d2ec2ca7ca63ee0b9fc602c62780051a97d5746339e2fd3484dba0f73d9079adf05d01a7229beebcc5cc118d7b4145c9a11e5ea97ba7162dce342a7d98b22353c19daa32e45fa9cec04af8483cc1714c2cfa8abc18b8b8da5a0d31628c674bb296426e2a730e733a25b6a371e458f528951b1c1cf96a4d7032b5ce0c03dec66481dca5a9a5ad9fbb0f8236615cef49156f2fa81d80103ebb05ea6679f52c1a6137";

        let c2: string = "447fba7311eff73e2736c30b7282634824a244a82eb90f259f18fc1a26a926f68522800a13fc43ffbef5e2fae5649f4d99d3c777548e561dd9bbf5903efdac5c9e2f7426b632794a372e594bce0e051f770c63927fc8d0cc4b7a92fe7f61a55087455c9f275368520fed1cddcbc553f9f43859ea09fec64379532c77964b0850147f79c1341bd7d121599c09b7a634857b274e942c522d1d390ce025f65a60e0befe09165399eb7113936d1957be622b5c53245a6352bab25cd0c1bced9b6adece9e50e2d55cd23f728c5844d78f4475ab03e5ed62ec9fce896a5c1cfe9fb1a95bea8ccacdc2098e7c53581fa9e10515cd0d022c6e062ab32ef5dc95f4eec8b9";
        let d2: string = "54c1d885cc853535ad602b2f1f358212a798484d2e800494a5f84c572f8a9668e5c6813807d74d2f5674ead5335c2f623e45237e856f0e09c96d39afc4bcb8ddc633249367699936740a34f6f2b2a2bbd61c62d28c44f4040b4b5e0932bf404bb6447771910470e25729b04cd2a463d1af4d6a1341b17fd857c08497fcf39effc8e7f1aa2f835229ac2e14a3f092e96ce9c33316a7e1ea7f7a9710bfb73bd19aa88f1479496441c769758be1a6731375de198444c446a40e77a930f7d0922f86293ce11877123250071775c094209e8bfa1eb88a86e60a6296408e1478d0c5afbbe5f886463dff1d4b7bd72cf2a73cdb3acfdac9bb38f332a4d858e868427b1e";

        let c3: string = "e2c06300ecfe5d48f887b5457bde231468895d33c1d6212a71bbdf9ee64ee0b21f97629bd5916d0f22aee4767822873061093a143729257226901aef7b2a82358be5c59806b89fd417046309e89049b23f93351d8c93fe3c89116321d69b8c99d092c388121879c729116275c6a97c83bc69e3dda78333282656eff248bfb9070f22169d20015240839736422d1915fe2194d034cd8eff4b48f6bd794b4d7003481b8f0c0edf2b39e379721b98ae427e99e0248fd7e9bc754ef7d40bfb064eb308430b870d44ac9795da367a7583857b2b5a839b324ee0069b116190592a5f2811d70985ca05e32f8e1c805710e468bae49cf142e6482a554fe7ada05bd2f159";
        let d3: string = "895ec1f9a3953898cac67857b0f24b0242e4f1c7e2cf773ace4c65478baf8cd11b9101b38b7b8693501f76637c9a189499ab03412f96bfa3cf29e7e72a75a1f47cd3fd648402455ab38a6fec9c6cb4b00add2b4d31b3e8567406d44b31023c7acb3b0e81cba3ab5db8776f8d44b5f40750e90ad67dccedfc5ad5918489bc02416701b1c885aa531784c6b05134ba1ccca78ebdacf3455627107105053da3ca5c926c66920a5882289fdaf70fcd8c0d0e779a7b9db092145d410eed9bc39337a6e3ee35e29486cc9137e69f5c5d77a68763f616a44e16f790c2ca2b6267840e6744f774f4b56328b66b16944a70c025d6b6d53dfd467f60de840a2a81ce28e24f";

        let c4: string = "880cd9a959e41a1d27eafe7ce9cd41fb5d2ae78ce36dda08c1eb93ef3c7d5c6e8d7970ba030ad462cfa918f74d970fd24140090973eda002f61d8242b94ece7941d040832b0b0a1cb2c35a178797655fd0edaf3232426b5ebe2587e0808b6166268b4855128a0c977490ed42b59d3a3ebb7ffeede7ffd785a1682966048631f612e3dcc9a3b2cba6d0b1c6a5a115922b8e3dbe10909a7a0f8b3b40b2733e6bcb0ba2b252a64558357b0bdedd62d317ae7b67794d6cd3aae7fae2b6da5ab33fe2306ff261c8d2193eaad2d115733760ed20df03056a13fa80b14e345af473a973c46c2210ab6c5d6ba901f3c2bfd690b364293de5d79147236b4abc806eb0b6c9";
        let d4: string = "5092a52b338eb9d1be6de23da6c7dbe6370c5f5c645b59379439f979cf375fb83510feb04d91885a1b9c056caf69d4b7e3de15e64f6d5e77d25319bff19778bbb56420a2e8d484da3155fda9b04a49d645f2a5daf4e86a92dd1a34cc1854b8b815d45deccbc88f6b405e152a39c112e2e3309f7554ac13112910ab7f26cd2aa37dc9c1c6e604e0f0b6c0862a302f0642d4ba46c1af2a2427a71eff0be13b5a4150276726b13f6a0e00f98c9d66c2fab1bf732dddcafa45022edfee9de5438c3c6cf02ef17de086362407acec4d01f6263d4c40ded1fd48f8aa516b9f555cb4ff15698e75509b42f1769b51b9e271c0dfea2c325d46a94e1d6c424f2ae510e312";

        let c5: string = "a0f57bf09309de60badb10aba4dc6986cd8c06164ece6b036153aa16bc53f8bfd41b97e6c4fd31e5b150d6ae885e1fe5e785d9a1d4371ab2378360d9305c432dbf74c95a521aff30bd9f91a153c029fb86a566e43d92848537d5603148716335fc302af07edece6e1e70b3d377c05931c04cc05951333dac051ff2fe39a58700530cedf4fd001c2e6db23995ae1fcf08d15fce3581606618de1922ab3b9898d42a7265bc9fd73c94e8bfaf0f4c298218b066512858402467e5ac653fc84dec3d78d3e83a4b0f14d378bc89de47e0292851c9394c964a79457aa84a751ed067cc33692c2652b182a751f80d246a801663b6cc9727cb7c78e24eea5ceefc001d3b";
        let d5: string = "b23c802397ca140255ff0fe5edc2770005935694041b99b0d7753a60404a3486bfd059d65265b809aa85f2fd41c115e0a293aa40ddeede11d7031998282da406a019f669262edf9fa1d530daa8991eef44071b083034891b2f1d65d05994385fe344a0679708dd424e4a02f426a062808f9c2265de761c9874c6b005b37e2104f625685812190179bb947c122598b8da347d703857c4dcc6303436b2015dcf2ac57a8eaa278a9dd1224e0d17876e9262796d3ecb40c6eb3fbd1b634b1759e326c38176358c228cebddf280d638081abce1f5367b1f558a957a298798d50ac93c2c601d7b29c37ab023b862733daedfa609a298a026915d9d5b269ad9b43cc465";

        let result: string = HashHelper.getCipherHash([{
            c: BigNumberHelper.fromHexString(c1),
            d: BigNumberHelper.fromHexString(d1)
        }, {
            c: BigNumberHelper.fromHexString(c2),
            d: BigNumberHelper.fromHexString(d2)
        }, {
            c: BigNumberHelper.fromHexString(c3),
            d: BigNumberHelper.fromHexString(d3)
        }, {
            c: BigNumberHelper.fromHexString(c4),
            d: BigNumberHelper.fromHexString(d4)
        }, {
            c: BigNumberHelper.fromHexString(c5),
            d: BigNumberHelper.fromHexString(d5)
        }]);

        console.log(result);
        expect(result.substring(0,2)).toStrictEqual("19");

    });
});